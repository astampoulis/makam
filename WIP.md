- [ ] add offset tracking state
- [ ] Haskell-like example
